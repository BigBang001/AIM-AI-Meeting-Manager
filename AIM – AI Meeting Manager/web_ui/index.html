<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AIM - AI Meeting Manager</title>
<style>
:root {
    --bg-light: #f5f5f5;
    --bg-dark: #0f1117;
    --card-light: #fff;
    --card-dark: #1b1f2a;
    --text-light: #111;
    --text-dark: #e4e6eb;
    --accent: #4f46e5;
    --accent-hover: #6366f1;
    --border: #ccc;
    --radius: 12px;
    --transition: 0.3s ease;
}

body {
    font-family: "Inter", sans-serif;
    background-color: var(--bg-light);
    color: var(--text-light);
    margin:0;
    padding:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    min-height:100vh;
    transition: all var(--transition);
}

body.dark {
    background-color: var(--bg-dark);
    color: var(--text-dark);
}

h1 {margin-top:30px;font-size:1.8rem;text-align:center;letter-spacing:0.5px;}

.container {
    width:90%; max-width:800px;
    background-color: var(--card-light);
    padding:25px;
    border-radius: var(--radius);
    margin-top:20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    transition: all var(--transition);
}

body.dark .container {
    background-color: var(--card-dark);
    box-shadow: 0 4px 30px rgba(0,0,0,0.5);
}

textarea {
    width:100%;
    border-radius: var(--radius);
    border:1px solid var(--border);
    padding:12px;
    resize:none;
    background-color: inherit;
    color: inherit;
    font-size:1rem;
    outline:none;
}

textarea:focus {
    border-color: var(--accent);
}

.buttons {display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;}
button {
    flex:1;
    padding:10px;
    border:none;
    border-radius:var(--radius);
    cursor:pointer;
    background-color: var(--accent);
    color:white;
    font-weight:600;
    transition:all var(--transition);
}
button:hover {background-color: var(--accent-hover); transform: translateY(-1px);}

.theme-toggle {
    position:absolute; top:15px; right:20px; font-size:1.6rem; cursor:pointer; background:none; border:none; color:inherit;
}

.sections {margin-top:20px;}
.section {margin-bottom:20px;}
.section h2 {margin-bottom:8px; font-size:1.1rem;}
.prompt-entry {background-color: rgba(0,0,0,0.03); padding:8px 12px; border-radius:var(--radius); margin-bottom:6px; display:flex; justify-content:space-between; align-items:center; transition: all var(--transition);}
body.dark .prompt-entry {background-color: rgba(255,255,255,0.05);}
.prompt-entry button {flex:none; background-color:var(--accent); color:white; padding:4px 8px; font-size:0.85rem; border-radius:var(--radius);}
.memory-bar {margin-top:15px; font-weight:600;}
</style>
</head>
<body>
<h1>üß† AIM - AI Meeting Manager</h1>
<button class="theme-toggle" id="theme-toggle">üåô</button>

<div class="container">
    <textarea id="promptInput" rows="3" placeholder="Enter your meeting prompt..."></textarea>
    <div class="buttons">
        <button id="addPrompt">Add Prompt</button>
        <button id="undo">Undo</button>
        <button id="finalize">Finalize</button>
    </div>

    <div class="memory-bar" id="memoryBar">[‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°‚ñ°] Tokens: 0/50</div>

    <div class="sections">
        <div class="section">
            <h2>Active</h2>
            <div id="activeContainer"></div>
        </div>
        <div class="section">
            <h2>Finalized</h2>
            <div id="finalizedContainer"></div>
        </div>
        <div class="section">
            <h2>Pinned</h2>
            <div id="pinnedContainer"></div>
        </div>
        <div class="section">
            <h2>History / Dynamic Recap</h2>
            <div id="recapContainer"></div>
        </div>
    </div>
</div>

<script>
const maxTokens = 50;
let memory = []; // {prompt, responses, finalized, pinned, timestamp}
let tokensUsed = 0;

// Utility: count tokens (words)
function countTokens(text){ return text.trim().split(/\s+/).length; }

// Generate AI response automatically
function generateAIResponse(prompt){
    const choices = [
        "Let's review action items.",
        "Assign next tasks accordingly.",
        "Schedule follow-up discussion.",
        "Highlight any blockers found.",
        "Make sure everyone is aligned."
    ];
    return choices[Math.floor(Math.random()*choices.length)];
}

// Add prompt
document.getElementById("addPrompt").addEventListener("click",()=>{
    const text=document.getElementById("promptInput").value.trim();
    if(!text) return alert("Please enter a prompt!");

    const aiResp = generateAIResponse(text);
    const requiredTokens = countTokens(text) + countTokens(aiResp);

    // Remove oldest unpinned if over maxTokens
    while(tokensUsed + requiredTokens > maxTokens){
        const idx = memory.findIndex(e=>!e.pinned);
        if(idx>=0){
            const removed = memory.splice(idx,1)[0];
            tokensUsed -= countTokens(removed.prompt);
            removed.responses.forEach(r=>tokensUsed-=countTokens(r));
        } else break;
    }

    const entry = {prompt:text,responses:[aiResp],finalized:false,pinned:false,timestamp:new Date()};
    memory.push(entry);
    tokensUsed += requiredTokens;

    updateUI();
    document.getElementById("promptInput").value="";
});

// Undo last response
document.getElementById("undo").addEventListener("click",()=>{
    const lastActiveIdx = memory.map((e,i)=>!e.finalized?i:null).filter(i=>i!==null).pop();
    if(lastActiveIdx===undefined) return alert("No responses to undo!");

    const last = memory[lastActiveIdx];
    if(last.responses.length>0){
        const removed = last.responses.pop();
        tokensUsed -= countTokens(removed);
        if(last.responses.length===0) memory.splice(lastActiveIdx,1);
    }
    updateUI();
});

// Finalize last active prompt
document.getElementById("finalize").addEventListener("click",()=>{
    const lastActiveIdx = memory.map((e,i)=>!e.finalized?i:null).filter(i=>i!==null).pop();
    if(lastActiveIdx===undefined) return alert("Nothing to finalize!");

    memory[lastActiveIdx].finalized=true;
    updateUI();
});

// Pin a prompt
function pinPrompt(idx){
    memory[idx].pinned=true;
    updateUI();
}

// Update UI
function updateUI(){
    const activeContainer=document.getElementById("activeContainer");
    const finalizedContainer=document.getElementById("finalizedContainer");
    const pinnedContainer=document.getElementById("pinnedContainer");
    const recapContainer=document.getElementById("recapContainer");

    activeContainer.innerHTML="";
    finalizedContainer.innerHTML="";
    pinnedContainer.innerHTML="";
    recapContainer.innerHTML="";

    memory.forEach((e,i)=>{
        const time = e.timestamp.toLocaleTimeString();
        const resText = e.responses.join(" / ");
        const div=document.createElement("div");
        div.className="prompt-entry";
        div.innerHTML=`<div><b>${e.finalized?"FINALIZED":"ACTIVE"} - ${e.prompt}</b> ‚Üí ${resText} (${time})</div> <button onclick="pinPrompt(${i})">Pin</button>`;
        if(e.pinned) pinnedContainer.appendChild(div);
        else if(e.finalized) finalizedContainer.appendChild(div);
        else activeContainer.appendChild(div);

        recapContainer.innerHTML+=`<div>${e.prompt} ‚Üí ${resText}</div>`;
    });

    // Update memory bar
    const barLen=8;
    const filled=Math.min(barLen,Math.floor(barLen*tokensUsed/maxTokens));
    document.getElementById("memoryBar").innerText=`[${"‚ñ†".repeat(filled)}${"‚ñ°".repeat(barLen-filled)}] Tokens: ${tokensUsed}/${maxTokens}`;
}

// Dark/light toggle
const themeToggle=document.getElementById("theme-toggle");
themeToggle.addEventListener("click",()=>{
    document.body.classList.toggle("dark");
    themeToggle.textContent = document.body.classList.contains("dark")?"‚òÄÔ∏è":"üåô";
});
</script>
</body>
</html>
